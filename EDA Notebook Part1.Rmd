---
title: "R Notebook"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

```{r}
#Install the packages
install.packages("tidyverse")
library(tidyverse)
```

###Q1.Reading the data into R in a tabular format, identifying,
subsetting, and renaming the variables for your use

```{r}
raw = read.csv('/Users/harrychen/Downloads/raw_data.csv') #Remove rows with NA critic scores
data = raw %>% drop_na(Critic_Score, User_Score)

dim(raw)
dim(data)
head(data)
```

```{r}
#Subsetting the features of the game (independent variable)
#Four variables we consider important:
x1 <- c("Name", "Platform", "Year_of_Release", "Genre", "Publisher")
x_imp <- data[x1]
head(x_imp)
```

```{r}
#Separate games based on critic scores into three levels: low, medium, high
min(data["Critic_Score"])
max(data["Critic_Score"])
(98-13)/3
low_score <- data %>% filter(Critic_Score <= 41.3)
med_score <- data %>% filter(between(Critic_Score, 42, 70))
high_score <- data %>% filter(Critic_Score >= 71)
```

#### Identifying name and unit of variables:

We don't need to rename the variabales, because the original dataset
from kaggle is well-formatted, and we only need to explain some
variables.

NA_Sales: EU_Sales: JP_Sales: Other_Scales: Critic_Score: User_Score:
Rating:

xx_Sales are in millions.

### Q2. Forming the core data frame that you'll be working from by reshaping and summarizing the data, storing new data frames in memory where appropriate

```{r}
#Data frame that specifies on USER's opinion on the games (Might be useful)
user_data <- data %>% drop_na(User_Count)
```

```{r}
#Summarize important variables
df1 <- data %>% group_by(Platform) %>% summarise(n = n(), mean_score = mean(Critic_Score)) %>% arrange(desc(mean_score))
df1
df2 <- data %>% group_by(Genre) %>% summarise(n = n(), mean_score = mean(Critic_Score)) %>% arrange(desc(mean_score))
df2
df3 <- data %>% group_by(Publisher) %>% summarise(n = n(), mean_score = mean(Critic_Score)) %>% arrange(desc(n))
df3
```
We can see that in df3, there are too many publishers, and some of them only published few games but have high scores. 



### Q3. Cleaning the data according to your purpose for the dataset

```{r}
#First purpose: See which factors lead to high critic score.
#Maybe we can clean df3?
```
This step is done in previous two questions.



### Q4. Plotting distributions of your data

```{r}
library(ggplot2)
p <- ggplot(data, aes(x=Genre, y=Critic_Score)) + geom_boxplot() 
p
df3 <- data[, c('Year_of_Release', 'Critic_Score')] %>% drop_na(Year_of_Release)
df4 <- df3 %>% group_by(Year_of_Release) %>% summarise(mean_score = mean(Critic_Score)) %>% arrange(Year_of_Release) 
df4 <- slice(df4, 1:(n() - 1)) #Remove the last NA row(I can't delete it by drop_na)
df4$Year_of_Release <- df4$Year_of_Release
q2 <- ggplot(data=df4, aes(x=Year_of_Release, y=mean_score)) + geom_path()+ geom_point()
q2 + theme(axis.text.x = element_text(angle =90, vjust = 0.5, hjust=1)) 
```


### Q5. Calculating basic statistical metrics like central tendency measures

To calculate the central tendency measures, we can use the 'summary()' function in R. 
```{r}
# use Critic_score as an example
summary(data$Critic_Score)
```
Then if we want to calculate the central tendency measures for different subsets of the data we metioned in previous question, we can use the 'group_by()' and 'summarise()' functions from the dplyr package. 
```{r}
library(dplyr)

data %>% 
  group_by(Genre) %>% 
  summarise(mean_Critic_Score = mean(Critic_Score))

```

### Q6. Some light correlational analysis/visualization of key variables.

To perform correlational analysis between two variables, we will use 'cor()'. Because it is possible for the variables to contain different type and na values, we use 'pairwise.complete.obs' argument to only use complete observations in the calculation of the correlation coefficient
```{r}
#Take Critic score and Genre as an example
data$User_Score <- as.numeric(data$User_Score)
cor_result <- cor(data$Critic_Score, data$User_Score, use = "pairwise.complete.obs")
cor_result
```
To visualize the correlation between two variables, we will plot the scatterplot for the two variables.

This will create a scatter plot with Critic_Score on the x-axis and User_Score on the y-axis. 
```{r}
ggplot(data, aes(x = Critic_Score, y = User_Score)) +
  geom_point()
  labs(x = "Critic Score", y = "User Score") +
  theme_bw()
```

###Q7. A look forward to what further questions the analysis suggests and what it enables

Based on the current analysis, some further questions that could be explored include:

1. Is there a relationship between games platform and rating. To be more specific, are there any significant differences in 'Critic_Score' between different 'Platform' categories? 
We can possibly use some hypothesis tests, such as a t-test or ANOVA to explore this question.

2. Are games that are more recent generally have better rating? To be more specific, Does the Year_of_Release of a game have an impact on its Critic_Score? 
We can possibly use a linear regression model to explore this question.

3. For the other variables such as 'NA_Sales', 'EU_Sales', 'JP_Sales', and 'Other_Sales', can we find any relationship or trend from them?
We can possibly use visualization such as line graph to explore this question.

By making analysis to these questions, we will be able to make some preliminary conclusions about the data. If there are many highly rated games in the early years, such as 2010, we can infer that the high rating is not solely based on hardware advancement or graphics, but also on the gameplay.

Furthermore, if we know that a platform contains a lot of game in the high rating games group, then we can infer that this platform must have good productivity, which can provide recommendation to consumers to buy this platform's game

